---
title: "02. ìŠ¤í‚¤ë§ˆ ì •ì˜ (Schema Basics)"
description: "ë°ì´í„°ë² ì´ìŠ¤ì˜ ë¼ˆëŒ€ë¥¼ ë§Œë“œëŠ” ì‘ì—…ì…ë‹ˆë‹¤. í…Œì´ë¸”, ì»¬ëŸ¼, ì¸ë±ìŠ¤ ë“± ìŠ¤í‚¤ë§ˆì˜ ê¸°ì´ˆë¥¼ ë‹¤ë£¹ë‹ˆë‹¤."
date: "2026-02-16"
---

ë°ì´í„°ë² ì´ìŠ¤ì˜ ë¼ˆëŒ€ë¥¼ ë§Œë“œëŠ” ì‘ì—…ì…ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œ ê°€ì¥ ìì£¼ ì—´ì–´ë³´ê²Œ ë  **"ì„¤ê³„ë„"**ì…ë‹ˆë‹¤.

---

## ğŸ›ï¸ 1. ê¸°ë³¸ êµ¬ì¡°: í…Œì´ë¸” ì •ì˜

Drizzleì—ì„œ í…Œì´ë¸”ì€ `pgTable` í•¨ìˆ˜ë¡œ ì •ì˜í•©ë‹ˆë‹¤. ì²« ë²ˆì§¸ ì¸ìëŠ” **DB í…Œì´ë¸”ëª…**, ë‘ ë²ˆì§¸ ì¸ìëŠ” **ì»¬ëŸ¼ ì •ì˜ ê°ì²´**ì…ë‹ˆë‹¤.

```typescript
// src/db/schema/users.ts
import { pgTable, serial, text, timestamp, boolean } from 'drizzle-orm/pg-core';

export const users = pgTable('users', {
  // 1. ì»¬ëŸ¼ ì •ì˜
  id: serial('id').primaryKey(),
  email: text('email').notNull().unique(), // ì²´ì´ë‹ìœ¼ë¡œ ì œì•½ì¡°ê±´ ì¶”ê°€
  role: text('role', { enum: ['admin', 'user'] }).default('user'),
  isActive: boolean('is_active').default(true),
  
  // 2. ë‚ ì§œ ìë™ ê´€ë¦¬
  createdAt: timestamp('created_at').defaultNow(),
  updatedAt: timestamp('updated_at').defaultNow().$onUpdate(() => new Date()),
}, (table) => {
  // 3. í…Œì´ë¸” ë ˆë²¨ ì„¤ì • (ì¸ë±ìŠ¤, ë³µí•©í‚¤ ë“±)
  return {
    emailIdx: index('email_idx').on(table.email),
  };
});
```

> ï¿½ **Tip (CamelCase vs SnakeCase)**
> - **JS ë³€ìˆ˜ëª…**: `isActive` (ì½”ë“œì—ì„œ ì“¸ ë•Œ)
> - **DB ì»¬ëŸ¼ëª…**: `is_active` (DBì— ì €ì¥ë  ë•Œ)
> Drizzleì´ ë‚´ë¶€ì ìœ¼ë¡œ ìë™ ë§¤í•‘í•´ì¤ë‹ˆë‹¤. DBëŠ” snake_caseê°€ êµ­ë£°!

---

## ğŸ’ 2. í•„ìˆ˜ ì»¬ëŸ¼ íƒ€ì… ì´ì •ë¦¬ (Cheat Sheet)

ì‹¤ë¬´ì—ì„œ ìì£¼ ì“°ëŠ” PostgreSQL íƒ€ì…ë“¤ì…ë‹ˆë‹¤.

### ğŸ”¤ ë¬¸ìì—´ (String)

| í•¨ìˆ˜ | ì„¤ëª… | ì˜µì…˜ ì˜ˆì‹œ | ë¹„ê³  |
|------|------|-----------|------|
| `text('name')` | ì œí•œ ì—†ëŠ” í…ìŠ¤íŠ¸ | - | Postgresì—ì„  `varchar`ë³´ë‹¤ `text` ê¶Œì¥ (ì„±ëŠ¥ ì°¨ì´ ì—†ìŒ) |
| `varchar('name')` | ê¸¸ì´ ì œí•œ ë¬¸ìì—´ | `{ length: 256 }` | MySQL ë§ˆì´ê·¸ë ˆì´ì…˜ ê³ ë ¤ ì‹œ ì‚¬ìš© |
| `char('code')` | ê³ ì • ê¸¸ì´ ë¬¸ìì—´ | `{ length: 2 }` | êµ­ê°€ ì½”ë“œ(`KR`, `US`) ë“±ì— ì í•© |

### ğŸ”¢ ìˆ«ì (Number)

| í•¨ìˆ˜ | ì„¤ëª… | ë¹„ê³  |
|------|------|------|
| `serial('id')` | **ìë™ ì¦ê°€ ì •ìˆ˜** (1, 2, 3...) | ì†Œê·œëª¨/ì¤‘ê·œëª¨ í”„ë¡œì íŠ¸ Primary Key |
| `integer('age')` | ì¼ë°˜ ì •ìˆ˜ (4ë°”ì´íŠ¸) | ë‚˜ì´, ê°œìˆ˜, ìˆœì„œ |
| `bigint('price', { mode: 'number' })` | í° ì •ìˆ˜ (8ë°”ì´íŠ¸) | ê¸ˆìœµ, ì¡°íšŒìˆ˜. `mode: 'number'` ì•ˆ í•˜ë©´ JSì—ì„œ `BigInt` íƒ€ì… ë¨(ì£¼ì˜) |
| `numeric('rate', { precision: 5, scale: 2 })` | ì†Œìˆ˜ì  (`999.99`) | í™˜ìœ¨, ë„ëŸ‰í˜• ë“± ì •ë°€ ì—°ì‚° í•„ìš” ì‹œ |
| `doublePrecision('score')` | ë¶€ë™ì†Œìˆ˜ì  | ê³¼í•™ ì—°ì‚°, ëŒ€ëµì ì¸ ì‹¤ìˆ˜ ê°’ |

> **UUID vs Serial**
> - **`serial`**: ì½ê¸° ì‰½ê³  ìš©ëŸ‰ ì‘ìŒ. ë¶„ì‚° DB(ìƒ¤ë”©) í™˜ê²½ì—ì„  ì¶©ëŒ ìœ„í—˜.
> - **`uuid`**: ì „ ì„¸ê³„ ìœ ì¼. ë¶„ì‚° í™˜ê²½ í•„ìˆ˜. URLì— ë…¸ì¶œë¼ë„ ìœ ì¶” ë¶ˆê°€ëŠ¥.
> - **ì‹¤ë¬´ ì¶”ì²œ**: ì´ˆê¸° ìŠ¤íƒ€íŠ¸ì—…ì€ `serial`ë¡œ ì¶©ë¶„, ë³´ì•ˆì´ ì¤‘ìš”í•˜ê±°ë‚˜(ID ìœ ì¶” ë°©ì§€) ëŒ€ê·œëª¨ í™•ì¥ì´ ì˜ˆì •ë˜ë©´ `uuid` ì‚¬ìš©.

### ğŸ“… ë‚ ì§œ/ì‹œê°„ (Time)

| í•¨ìˆ˜ | ì„¤ëª… | ì¶”ì²œ ì„¤ì • |
|------|------|-----------|
| `timestamp('at')` | ë‚ ì§œ + ì‹œê°„ | `.withTimezone()` (UTC ì €ì¥ ê¶Œì¥) |
| `date('dob')` | ë‚ ì§œë§Œ (ìƒì¼ ë“±) | - |
| `time('start')` | ì‹œê°„ë§Œ (ê·¼ë¬´ì‹œê°„ ë“±) | - |
| `interval('duration')` | ì‹œê°„ ê°„ê²© | - |

> **Best Practice**: `timestamp`ëŠ” ê°€ëŠ¥í•˜ë©´ `{ withTimezone: true }`ë¥¼ ì“°ì„¸ìš”. ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤ì˜ ì•…ëª½(ì‹œì°¨ ê³„ì‚°)ì„ ë§‰ì•„ì¤ë‹ˆë‹¤.

### ğŸ“¦ ê¸°íƒ€ ìœ ìš©í•œ íƒ€ì…

| í•¨ìˆ˜ | ì„¤ëª… | í™œìš© ì˜ˆì‹œ |
|------|------|-----------|
| `boolean('is_ok')` | `true` / `false` | í™œì„±/ë¹„í™œì„±, ì‚­ì œ ì—¬ë¶€ |
| `json('data')` / `jsonb('data')` | JSON ê°ì²´ ì €ì¥ | **`jsonb` ì¶”ì²œ** (ì¸ë±ì‹±/ê²€ìƒ‰ ê°€ëŠ¥) |
| `pgEnum('role', [...])` | ì—´ê±°í˜• (Enum) | ê³ ì •ëœ ê°’ ëª©ë¡ (User Role, Status) |

---

## ï¿½ï¸ 3. ì»¬ëŸ¼ ì˜µì…˜ & ì œì•½ì¡°ê±´ (Chain Methods)

í•¨ìˆ˜ ë’¤ì— ì (`.`)ì„ ì°ì–´ ì œì•½ì¡°ê±´ì„ ê²ë‹ˆë‹¤.

- **`.notNull()`**: `NULL` ê¸ˆì§€. (í•„ìˆ˜ ê°’)
- **`.default(ê°’)`**: ê°’ ì•ˆ ë„£ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©. (`.default(0)`, `.default(false)`)
- **`.defaultNow()`**: (ë‚ ì§œ ì „ìš©) í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì„¤ì •. `created_at` êµ­ë£°.
- **`.primaryKey()`**: ê¸°ë³¸í‚¤ ì„¤ì •.
- **`.unique()`**: ì¤‘ë³µ ê¸ˆì§€. (ì´ë©”ì¼, ì£¼ë¯¼ë²ˆí˜¸ ë“±)
- **`.$onUpdate(() => new Date())`**: (ORM ë ˆë²¨) ë°ì´í„° ìˆ˜ì •ë  ë•Œë§ˆë‹¤ ìë™ ì‹¤í–‰. `updated_at`ì— í•„ìˆ˜.

---

## ğŸ—ï¸ 4. í…Œì´ë¸” ë ˆë²¨ ì„¤ì • (Advanced Configuration)

ì»¬ëŸ¼ ì •ì˜ ê°ì²´ ë’¤ì— ì˜¤ëŠ” **ì„¸ ë²ˆì§¸ ì¸ì(ì½œë°± í•¨ìˆ˜)**ì…ë‹ˆë‹¤.
ì´ê³³ì—ì„œëŠ” **ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ì¡°í•©** í•˜ê±°ë‚˜ **ë³µì¡í•œ ì œì•½ì¡°ê±´** ì„ ì„¤ì •í•©ë‹ˆë‹¤.

### â“ ì»¬ëŸ¼ vs í…Œì´ë¸” ë ˆë²¨: ì–¸ì œ ë¬´ì—‡ì„ ì“¸ê¹Œ?
| êµ¬ë¶„ | ì»¬ëŸ¼ ë ˆë²¨ (`.unique()`) | í…Œì´ë¸” ë ˆë²¨ (`unique().on(...)`) |
|------|-------------------------|--------------------------------|
| **ëŒ€ìƒ** | í•´ë‹¹ ì»¬ëŸ¼ 1ê°œ | 1ê°œ ì´ìƒì˜ ì»¬ëŸ¼ ì¡°í•© |
| **ìš©ë„** | ë‹¨ìˆœ ì œì•½ (ì´ë©”ì¼ ì¤‘ë³µ ê¸ˆì§€) | ë³µí•© ì œì•½ (ê°™ì€ ê·¸ë£¹ ë‚´ ì´ë¦„ ì¤‘ë³µ ê¸ˆì§€) |
| ** ê°€ë…ì„±**| ì§ê´€ì  (ì»¬ëŸ¼ ì˜†ì— ë°”ë¡œ ë³´ì„) | êµ¬ì¡°ì  (ì œì•½ì¡°ê±´ë§Œ ë”°ë¡œ ëª¨ì•„ì„œ ê´€ë¦¬) |

---

### ğŸ” 1. ì¸ë±ìŠ¤ (Indexes)
DB ì„±ëŠ¥ì˜ í•µì‹¬ì…ë‹ˆë‹¤. `WHERE`ë‚˜ `JOIN`ì— ìì£¼ ì“°ì´ëŠ” ì»¬ëŸ¼ì— ê±¸ì–´ì£¼ì„¸ìš”.

```typescript
(table) => ({
  // 1. ë‹¨ì¼ ì¸ë±ìŠ¤ (Single)
  // "ì´ë©”ì¼ë¡œ ê²€ìƒ‰í•  ì¼ì´ ë§ë‹¤"
  emailIdx: index('email_idx').on(table.email),

  // 2. ë³µí•© ì¸ë±ìŠ¤ (Composite) - â­ï¸ í…Œì´ë¸” ë ˆë²¨ì˜ ì¡´ì¬ ì´ìœ 
  // "ì„±ê³¼ ì´ë¦„ì„ ë™ì‹œì— ê²€ìƒ‰í•œë‹¤" (WHERE last_name = 'Kim' AND first_name = 'David')
  nameIdx: index('name_idx').on(table.lastName, table.firstName),

  // 3. ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ (Unique)
  // "í° ë²ˆí˜¸ëŠ” ì¤‘ë³µë˜ë©´ ì•ˆ ëœë‹¤" (ì œì•½ì¡°ê±´íš¨ê³¼ + ê²€ìƒ‰ì†ë„)
  phoneUnique: uniqueIndex('phone_idx').on(table.phone),
})
```
> **ğŸ’¡ Tip (Over-indexing)**:
> ì¸ë±ìŠ¤ëŠ” **'ì“°ê¸° ì†ë„'ë¥¼ í¬ìƒ** í•˜ê³  'ì½ê¸° ì†ë„'ë¥¼ ì–»ëŠ” ê²ƒì…ë‹ˆë‹¤. ë¬´ì§€ì„±ìœ¼ë¡œ ë‹¤ ê±¸ë©´ `INSERT/UPDATE`ê°€ ëŠë ¤ì§€ê³  ë””ìŠ¤í¬ë¥¼ ë§ì´ ì°¨ì§€í•©ë‹ˆë‹¤.
> - **í•„ìˆ˜**: Foreign Key, Unique Column
> - **ê¶Œì¥**: ìì£¼ ì¡°íšŒí•˜ëŠ” ì¡°ê±´ (`status`, `type`), ì •ë ¬ ê¸°ì¤€ (`created_at`)

---

### ğŸ›¡ï¸ 2. ì²´í¬ ì œì•½ì¡°ê±´ (Check Constraints)
DB ìˆ˜ì¤€ì—ì„œ ë°ì´í„°ì˜ **ìœ íš¨ì„±(Validation)** ì„ ê°•ì œí•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë²„ê·¸ë¡œ ì´ìƒí•œ ë°ì´í„°ê°€ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ì›ì²œ ì°¨ë‹¨í•©ë‹ˆë‹¤.

```typescript
import { sql } from 'drizzle-orm';

(table) => ({
  // "ë‚˜ì´ëŠ” 19ì„¸ ì´ìƒì´ì–´ì•¼ í•œë‹¤" (ë‹¨ìˆœ ê°’ ì²´í¬)
  ageCheck: check('age_check', sql`${table.age} >= 19`),

  // "í• ì¸ê°€ê²©ì€ ì •ê°€ë³´ë‹¤ ì‘ì•„ì•¼ í•œë‹¤" (ì»¬ëŸ¼ ê°„ ë¹„êµ â­ï¸)
  priceCheck: check('price_check', sql`${table.discountPrice} < ${table.normalPrice}`),
})
```
> **âš ï¸ ì£¼ì˜**: SQLite, MySQL ì¼ë¶€ ë²„ì „ì—ì„œëŠ” `CHECK` ì œì•½ì¡°ê±´ì´ ë¬´ì‹œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (PostgresëŠ” ì•„ì£¼ ì˜ ë™ì‘í•¨)

---

### ğŸ”‘ 3. ë³µí•© ê¸°ë³¸í‚¤ (Composite Primary Key)
ë‹¨ì¼ ì»¬ëŸ¼(`id`)ì´ ì•„ë‹ˆë¼, ë‘ ê°œ ì´ìƒì˜ ì»¬ëŸ¼ì„ í•©ì³ì„œ ì‹ë³„ìë¡œ ì“¸ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
ì£¼ë¡œ **N:M ê´€ê³„ì˜ ì—°ê²° í…Œì´ë¸”(Junction Table)** ì—ì„œ ì”ë‹ˆë‹¤.

```typescript
// users_to_groups í…Œì´ë¸”
(table) => ({
  // "ìœ ì €IDì™€ ê·¸ë£¹IDì˜ ìŒì€ ìœ ì¼í•´ì•¼ í•˜ë©°, ì´ê²ƒì´ ì‹ë³„ìë‹¤"
  pk: primaryKey({ columns: [table.userId, table.groupId] }),
})
```
> **Why?**: `userId=1`ì¸ í–‰ì´ ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆê³ , `groupId=5`ì¸ í–‰ë„ ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆì§€ë§Œ, (`1`, `5`) ì¡°í•©ì€ ë”± í•˜ë‚˜ë§Œ ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

---

### ğŸ”— 4. ë³µí•© ì™¸ë˜í‚¤ (Composite Foreign Key)
í”í•˜ì§„ ì•Šì§€ë§Œ, ë‘ ê°œ ì´ìƒì˜ ì»¬ëŸ¼ì´ í•©ì³ì ¸ì„œ ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ë³µí•© í‚¤ë¥¼ ì°¸ì¡°í•  ë•Œ ì”ë‹ˆë‹¤.

```typescript
(table) => ({
  // "ë‚´ í…Œì´ë¸”ì˜ (a, b) ì»¬ëŸ¼ì€ ë‹¤ë¥¸ í…Œì´ë¸”ì˜ (x, y)ë¥¼ ì°¸ì¡°í•œë‹¤"
  compositeFk: foreignKey({
    columns: [table.a, table.b],
    foreignColumns: [otherTable.x, otherTable.y],
    name: 'custom_fk_name' // ì´ë¦„ ì§ì ‘ ì§€ì •
  })
    .onDelete('cascade') // ë¶€ëª¨ ì‚­ì œ ì‹œ ìì‹ë„ ì‚­ì œ
    .onUpdate('cascade'),
})
```

---

## ğŸ“‚ 5. ì‹¤ì „ í´ë” êµ¬ì¡° (Reference)

```
src/db/
â”œâ”€â”€ schema/
â”‚   â”œâ”€â”€ index.ts          // ëª¨ë“  ìŠ¤í‚¤ë§ˆ export (ì§„ì…ì )
â”‚   â”œâ”€â”€ users.ts          // ë„ë©”ì¸ë³„ ë¶„ë¦¬
â”‚   â”œâ”€â”€ posts.ts
â”‚   â”œâ”€â”€ comments.ts
â”‚   â””â”€â”€ enums.ts          // Enumì€ ë”°ë¡œ ëª¨ì•„ë‘ë©´ ì¬ì‚¬ìš©í•˜ê¸° í¸í•¨
â”œâ”€â”€ index.ts              // DB ì—°ê²° ì„¤ì • (drizzle(...))
â””â”€â”€ migrate.ts            // ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
```

### `enums.ts` íŒ
```typescript
// enums.ts
import { pgEnum } from 'drizzle-orm/pg-core';

export const roleEnum = pgEnum('role', ['admin', 'manager', 'user']);
export const statusEnum = pgEnum('status', ['pending', 'active', 'blocked']);
```
ë‹¤ë¥¸ íŒŒì¼ì—ì„œ `import { roleEnum } from './enums'` í•´ì„œ ì“°ë©´ ê¹”ë”í•©ë‹ˆë‹¤.

---

## ğŸ”— ë ˆí¼ëŸ°ìŠ¤
- [All Column Types (PG)](https://orm.drizzle.team/docs/column-types/pg)
- [Indexes & Constraints](https://orm.drizzle.team/docs/indexes-constraints)

**ë‹¤ìŒ ì¥**: [03. ê´€ê³„ ì •ì˜ (Relations)](./03-relations.md)
