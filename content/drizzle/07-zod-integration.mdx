---
title: "07. Zod í†µí•© (Validation)"
description: "APIì˜ ì•ˆì •ì„±ì„ ì±…ì„ì§€ëŠ” ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¬í™” ê°€ì´ë“œì…ë‹ˆë‹¤. ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í„°ë§ˆì´ì§•ë¶€í„° ë³µí•© ê²€ì¦ ë¡œì§ê¹Œì§€ ë‹¤ë£¹ë‹ˆë‹¤."
date: "2026-02-16"
---

APIì˜ ì•ˆì •ì„±ì„ ì±…ì„ì§€ëŠ” ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¬í™” ê°€ì´ë“œì…ë‹ˆë‹¤. ì—ëŸ¬ ë©”ì‹œì§€ ì»¤ìŠ¤í„°ë§ˆì´ì§•ë¶€í„° ë³µí•© ê²€ì¦ ë¡œì§ê¹Œì§€ ë‹¤ë£¹ë‹ˆë‹¤.

---

## ğŸ› ï¸ 1. ìŠ¤í‚¤ë§ˆ ë””í…Œì¼ ì„¤ì • (Custom Messages)

ìë™ ìƒì„±ëœ ìŠ¤í‚¤ë§ˆì— **"ì¹œì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€"** ë¥¼ ì‹¬ì–´ì•¼ í•©ë‹ˆë‹¤. ì‚¬ìš©ìì—ê²Œ "Invalid Type"ì´ë¼ê³  ë³´ì—¬ì¤„ ìˆœ ì—†ìœ¼ë‹ˆê¹Œìš”.

```typescript
import { createInsertSchema } from 'drizzle-zod';

export const insertUserSchema = createInsertSchema(users, {
  // ì´ë©”ì¼ í•„ë“œ ì»¤ìŠ¤í„°ë§ˆì´ì§•
  email: (schema) => schema.email({ message: "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤." }),
  
  // íŒ¨ìŠ¤ì›Œë“œ: ê¸¸ì´ ì œí•œ + ë©”ì‹œì§€
  password: (schema) => schema.min(8, { message: "ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤." }),
  
  // ì„ íƒì  í•„ë“œ ì²˜ë¦¬ (ë¹ˆ ë¬¸ìì—´ -> null ì²˜ë¦¬ ë“±)
  bio: (schema) => schema.max(500).optional().or(z.literal('')),
});
```

---

## ğŸ›¡ï¸ 2. ë³µí•© ê²€ì¦ ë¡œì§ (Refine)

ë‹¨ì¼ í•„ë“œë¥¼ ë„˜ì–´, ì—¬ëŸ¬ í•„ë“œ ê°„ì˜ ê´€ê³„ë¥¼ ê²€ì¦í•  ë•Œ `refine`ì´ë‚˜ `superRefine`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```typescript
// ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë¡œì§ ì¶”ê°€
export const signupSchema = insertUserSchema
  .extend({
    confirmPassword: z.string(), // DBì—ëŠ” ì—†ì§€ë§Œ í¼ì—ëŠ” ìˆëŠ” í•„ë“œ
  })
  .refine((data) => data.password === data.confirmPassword, {
    message: "ë¹„ë°€ë²ˆí˜¸ê°€ ì„œë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    path: ["confirmPassword"], // ì—ëŸ¬ë¥¼ í‘œì‹œí•  í•„ë“œ ìœ„ì¹˜
  });
```

---

## âš™ï¸ 3. í˜•ë³€í™˜ (Coercion)

Query Stringì´ë‚˜ Form DataëŠ” ëª¨ë“  ê²Œ ë¬¸ìì—´ë¡œ ë“¤ì–´ì˜µë‹ˆë‹¤. ì´ë¥¼ ì•Œë§ì€ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

```typescript
// GET /posts?page=1&limit=10 
// -> { page: "1", limit: "10" } (ë¬¸ìì—´ì„)

export const paginationSchema = z.object({
  // ë¬¸ìì—´ "1"ì„ ìˆ«ì 1ë¡œ ë³€í™˜ í›„ ê²€ì¦
  page: z.coerce.number().min(1).default(1),
  limit: z.coerce.number().min(1).max(100).default(10),
});
```
`drizzle-zod`ì—ì„œë„ íŒ©í† ë¦¬ ì˜µì…˜ìœ¼ë¡œ ì „ì—­ ì ìš©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ë³´í†µì€ ê°œë³„ í•„ë“œì—ì„œ `z.coerce`ë¥¼ ì“°ëŠ” ê²Œ ëª…í™•í•©ë‹ˆë‹¤.

---

## ğŸ¨ 4. í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ (React Hook Form)

í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ë°±ì—”ë“œì™€ ìŠ¤í‚¤ë§ˆë¥¼ ê³µìœ í•˜ë©´ ì¤‘ë³µ ì½”ë“œê°€ 0ì´ ë©ë‹ˆë‹¤.

```typescript
// apps/client/src/features/auth/SignUpForm.tsx
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { type NewUser, insertUserSchema } from '@repo/schema'; // ê³µìœ  íŒ¨í‚¤ì§€

export const SignUpForm = () => {
  const { register, handleSubmit, formState: { errors } } = useForm<NewUser>({
    resolver: zodResolver(insertUserSchema), // Zod ìŠ¤í‚¤ë§ˆ ì—°ê²°
  });

  const onSubmit = (data: NewUser) => {
    // dataëŠ” ì´ë¯¸ ê²€ì¦ ì™„ë£Œë¨
    api.post('/users', data);
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input {...register('email')} />
      <p>{errors.email?.message}</p> {/* "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤" ì¶œë ¥ */}
      <button>ê°€ì…</button>
    </form>
  );
};
```

---

## ğŸ”— ë ˆí¼ëŸ°ìŠ¤
- [Zod Error Handling](https://zod.dev/?id=error-handling)
- [React Hook Form + Zod](https://react-hook-form.com/get-started#SchemaValidation)

**ë‹¤ìŒ ì¥**: [08. íƒ€ì… ì¶”ë¡  (Type Inference)](./08-type-inference.md)
