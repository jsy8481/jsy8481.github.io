---
title: "08. ì‹¤ì „ ê°œë°œ ê°€ì´ë“œ: í¬íŠ¸í´ë¦¬ì˜¤ ì„œë¹„ìŠ¤ ë§Œë“¤ê¸°"
description: "ì•ì„œ ë°°ìš´ ëª¨ë“  ê°œë…(ëª¨ë“ˆ, ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, Drizzle)ê³¼ Zodë¥¼ ì´ìš©í•œ SSOT íŒ¨í„´ìœ¼ë¡œ ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤."
date: "2026-02-16"
---

ì´ ê°€ì´ë“œëŠ” ì•ì„œ ë°°ìš´ ëª¨ë“  ê°œë…(ëª¨ë“ˆ, ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, Drizzle)ê³¼ **Zodë¥¼ ì´ìš©í•œ ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›(Single Source of Truth, SSOT)** íŒ¨í„´ì„ ì¢…í•©í•˜ì—¬ **"ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì„œë¹„ìŠ¤"** ë¥¼ ë°‘ë°”ë‹¥ë¶€í„° êµ¬í˜„í•˜ëŠ” ê³¼ì •ì„ ë‹¤ë£¹ë‹ˆë‹¤.

ì½”ë“œ í•˜ë‹¨ì—ëŠ” **ì‚¬ìš©ëœ ëª¨ë“  ë°ì½”ë ˆì´í„°ì™€ í•¨ìˆ˜ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…** ì´ í¬í•¨ë˜ì–´ ìˆì–´, ì´ ê°€ì´ë“œë§Œ ë³´ë”ë¼ë„ ì‹¤ì „ ê°œë°œì´ ê°€ëŠ¥í•˜ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

---

## 1. ëª©í‘œ ê¸°ëŠ¥

- **í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±**: ì´ë¦„ê³¼ ì„¤ëª…ìœ¼ë¡œ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.
- **í¬íŠ¸í´ë¦¬ì˜¤ ì¡°íšŒ**: ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ ëª©ë¡ì„ ë´…ë‹ˆë‹¤.
- **í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ì •**: ì´ë¦„ì„ ë³€ê²½í•©ë‹ˆë‹¤.
- **í¬íŠ¸í´ë¦¬ì˜¤ ì‚­ì œ**: í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.

---

## 2. ìŠ¤í‚¤ë§ˆ ì •ì˜ (Drizzle)

ê°€ì¥ ë¨¼ì € ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```typescript
// packages/schema/src/schema.ts
import { pgTable, serial, text, timestamp } from 'drizzle-orm/pg-core';

// 1. í¬íŠ¸í´ë¦¬ì˜¤ í…Œì´ë¸” ì •ì˜
export const portfolios = pgTable('portfolios', {
  id: serial('id').primaryKey(),          // ê³ ìœ  ID (ìë™ ì¦ê°€)
  userId: text('user_id').notNull(),      // ì†Œìœ ì ID (Supabase Auth ì—°ë™)
  name: text('name').notNull(),           // í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¦„
  description: text('description'),       // ì„¤ëª… (ì„ íƒ ì‚¬í•­)
  createdAt: timestamp('created_at').defaultNow(), // ìƒì„±ì¼
  updatedAt: timestamp('updated_at').defaultNow(), // ìˆ˜ì •ì¼
});

// 2. íƒ€ì… ì¶”ë¡  (Drizzleì˜ ê°•ë ¥í•œ ê¸°ëŠ¥)
export type Portfolio = typeof portfolios.$inferSelect; // SELECT ê²°ê³¼ íƒ€ì…
export type NewPortfolio = typeof portfolios.$inferInsert; // INSERT ì…ë ¥ íƒ€ì…
```

### ğŸ” ì½”ë“œ ë¶„ì„
| ì½”ë“œ | ì„¤ëª… |
|------|------|
| `pgTable` | Postgres í…Œì´ë¸”ì„ ì •ì˜í•˜ëŠ” Drizzle í•¨ìˆ˜ì…ë‹ˆë‹¤. ì²« ë²ˆì§¸ ì¸ìëŠ” í…Œì´ë¸”ëª…ì…ë‹ˆë‹¤. |
| `serial` | ìë™ ì¦ê°€í•˜ëŠ” ì •ìˆ˜í˜• ì»¬ëŸ¼(`SERIAL`)ì„ ì •ì˜í•©ë‹ˆë‹¤. ì£¼ë¡œ IDì— ì‚¬ìš©ë©ë‹ˆë‹¤. |
| `text` | ë¬¸ìì—´ ì»¬ëŸ¼(`TEXT`)ì„ ì •ì˜í•©ë‹ˆë‹¤. |
| `timestamp` | ë‚ ì§œ/ì‹œê°„ ì»¬ëŸ¼(`TIMESTAMP`)ì„ ì •ì˜í•©ë‹ˆë‹¤. |
| `primaryKey()` | í•´ë‹¹ ì»¬ëŸ¼ì„ ê¸°ë³¸í‚¤(Primary Key)ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. |
| `notNull()` | `NOT NULL` ì œì•½ ì¡°ê±´ì„ ì¶”ê°€í•˜ì—¬ í•„ìˆ˜ ê°’ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤. |
| `defaultNow()` | ê°’ì´ ì—†ì„ ë•Œ í˜„ì¬ ì‹œê°„(`NOW()`)ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. |
| `$inferSelect` | í…Œì´ë¸” ìŠ¤í‚¤ë§ˆì—ì„œ ì¡°íšŒìš© TypeScript íƒ€ì…ì„ ìë™ ì¶”ë¡ í•©ë‹ˆë‹¤. |
| `$inferInsert` | í…Œì´ë¸” ìŠ¤í‚¤ë§ˆì—ì„œ ì‚½ì…ìš© TypeScript íƒ€ì…ì„ ìë™ ì¶”ë¡ í•©ë‹ˆë‹¤. |

---

## 3. ëª¨ë“ˆ ìƒì„± ë° ì„¤ì •

NestJS CLIë¡œ ëª¨ë“ˆ êµ¬ì¡°ë¥¼ ì¡ìŠµë‹ˆë‹¤.

```bash
nest g resource portfolios
npm install nestjs-zod zode drizzle-zod
```

```typescript
// src/portfolios/portfolios.module.ts
import { Module } from '@nestjs/common';
import { PortfoliosService } from './portfolios.service';
import { PortfoliosController } from './portfolios.controller';
// DatabaseModuleì€ Globalì´ë¼ import ì•ˆ í•´ë„ ë¨

@Module({
  controllers: [PortfoliosController], // ìš”ì²­ì„ ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬
  providers: [PortfoliosService],      // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤
})
export class PortfoliosModule {}
```

### ğŸ” ì½”ë“œ ë¶„ì„
| ì½”ë“œ | ì„¤ëª… |
|------|------|
| `@Module()` | ì´ í´ë˜ìŠ¤ê°€ NestJS ëª¨ë“ˆì„ì„ ì•Œë¦¬ëŠ” ë°ì½”ë ˆì´í„°ì…ë‹ˆë‹¤. |
| `controllers` | ì´ ëª¨ë“ˆì— ì†í•œ ì»¨íŠ¸ë¡¤ëŸ¬(ìš”ì²­ ì²˜ë¦¬ê¸°) ëª©ë¡ì„ ì •ì˜í•©ë‹ˆë‹¤. |
| `providers` | ì´ ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•  ì„œë¹„ìŠ¤(ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§) ë° ì˜ì¡´ì„± ëª©ë¡ì„ ì •ì˜í•©ë‹ˆë‹¤. |

---

## 4. DTO: drizzle-zodë¥¼ ì´ìš©í•œ ì™„ë²½í•œ SSOT êµ¬í˜„

`drizzle-zod`ë¥¼ ì‚¬ìš©í•˜ë©´ **DB ìŠ¤í‚¤ë§ˆë¡œë¶€í„° Zod ê²€ì¦ ë¡œì§ì„ ìë™ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
DB ì»¬ëŸ¼ì˜ ì œì•½ ì¡°ê±´(ê¸¸ì´, íƒ€ì…, Null ì—¬ë¶€)ì´ ê·¸ëŒ€ë¡œ ê²€ì¦ ê·œì¹™ì´ ë˜ë©°, ì¶”ê°€ ê·œì¹™ì„ `refine`ìœ¼ë¡œ ë¶™ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> **ì„¤ì¹˜**: `npm install nestjs-zod zode drizzle-zod`

```typescript
// src/portfolios/dto/create-portfolio.dto.ts
import { createZodDto } from 'nestjs-zod';
import { createInsertSchema } from 'drizzle-zod';
import { portfolios } from '@repo/schema'; // Drizzle í…Œì´ë¸” ì •ì˜
import { z } from 'zod';

// 1. Drizzle ìŠ¤í‚¤ë§ˆë¡œë¶€í„° Zod ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„± (SSOT)
const CreatePortfolioSchema = createInsertSchema(portfolios, {
  // ì¶”ê°€ ê²€ì¦ ê·œì¹™ ì •ì˜ (DB ìŠ¤í‚¤ë§ˆ + @)
  name: (schema) => schema.min(2, 'ì´ë¦„ì€ ìµœì†Œ 2ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.').max(50),
  description: (schema) => schema.max(200).optional(),
}).pick({
  name: true,        // í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒ
  description: true,
});

// 2. NestJS DTOë¡œ ë³€í™˜
export class CreatePortfolioDto extends createZodDto(CreatePortfolioSchema) {}
```

```typescript
// src/portfolios/dto/update-portfolio.dto.ts
import { createZodDto } from 'nestjs-zod';
import { CreatePortfolioDto } from './create-portfolio.dto';

// Create ìŠ¤í‚¤ë§ˆë¥¼ ê°€ì ¸ì™€ì„œ ëª¨ë“  í•„ë“œë¥¼ optionalë¡œ ë³€ê²½ (Partial)
const UpdatePortfolioSchema = CreatePortfolioDto.schema.partial();

export class UpdatePortfolioDto extends createZodDto(UpdatePortfolioSchema) {}
```

> **Tip**: `main.ts`ì— `app.useGlobalPipes(new ZodValidationPipe());`ê°€ ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

### ğŸ” ì½”ë“œ ë¶„ì„
| ì½”ë“œ | ì„¤ëª… |
|------|------|
| `createInsertSchema` | `drizzle-zod` í•¨ìˆ˜ë¡œ, Drizzle í…Œì´ë¸” ì •ì˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚½ì…ìš© Zod ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•©ë‹ˆë‹¤. |
| `portfolios` | Drizzle í…Œì´ë¸” ê°ì²´ì…ë‹ˆë‹¤. ìŠ¤í‚¤ë§ˆ ìƒì„±ì˜ ì›ì²œ(Source)ì´ ë©ë‹ˆë‹¤. |
| `schema.min(n)` | ìë™ ìƒì„±ëœ Zod ìŠ¤í‚¤ë§ˆì— ì¶”ê°€ ê·œì¹™(ìµœì†Œ ê¸¸ì´)ì„ ë§ë¶™ì…ë‹ˆë‹¤. |
| `.pick({...})` | ìƒì„±ëœ ì „ì²´ ìŠ¤í‚¤ë§ˆì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì…ë ¥ë°›ì„ í•„ë“œë§Œ ì„ íƒí•©ë‹ˆë‹¤. (userId, createdAt ë“± ì œì™¸) |
| `createZodDto` | `nestjs-zod` í•¨ìˆ˜ë¡œ, Zod ìŠ¤í‚¤ë§ˆë¥¼ NestJS DTO í´ë˜ìŠ¤ë¡œ ë³€í™˜í•˜ì—¬ íƒ€ì… ì¶”ë¡ ê³¼ Swagger ë¬¸ì„œë¥¼ ìë™í™”í•©ë‹ˆë‹¤. |
| `.partial()` | ìŠ¤í‚¤ë§ˆì˜ ëª¨ë“  í•„ë“œë¥¼ ì„ íƒì (Optional)ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤. (ìˆ˜ì • ì‹œ ìœ ìš©) |

---

## 5. ì„œë¹„ìŠ¤ êµ¬í˜„ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

ì‹¤ì œ ë¡œì§ì„ êµ¬í˜„í•©ë‹ˆë‹¤. Drizzleì„ ì‚¬ìš©í•˜ì—¬ DBì™€ í†µì‹ í•©ë‹ˆë‹¤.

```typescript
// src/portfolios/portfolios.service.ts
import { Inject, Injectable, NotFoundException } from '@nestjs/common';
import { DATABASE_TOKEN, Database } from '../database/database.module';
import { portfolios, NewPortfolio } from '@repo/schema';
import { eq, and } from 'drizzle-orm';
import { CreatePortfolioDto } from './dto/create-portfolio.dto';
import { UpdatePortfolioDto } from './dto/update-portfolio.dto';

@Injectable()
export class PortfoliosService {
  constructor(
    @Inject(DATABASE_TOKEN) private readonly db: Database, // DB ì£¼ì…
  ) {}

  // 1. ìƒì„±
  async create(userId: string, dto: CreatePortfolioDto) {
    const newPortfolio: NewPortfolio = {
      ...dto,
      userId, // í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID í• ë‹¹
    };

    const [created] = await this.db
      .insert(portfolios)
      .values(newPortfolio)
      .returning(); // ìƒì„±ëœ ë°ì´í„° ë°˜í™˜

    return created;
  }

  // 2. ì „ì²´ ì¡°íšŒ (ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ë§Œ)
  async findAll(userId: string) {
    return this.db.query.portfolios.findMany({
      where: eq(portfolios.userId, userId), // ë‚´ ê²ƒë§Œ í•„í„°ë§
      orderBy: (p, { desc }) => [desc(p.createdAt)], // ìµœì‹ ìˆœ ì •ë ¬
    });
  }

  // 3. ë‹¨ì¼ ì¡°íšŒ
  async findOne(userId: string, id: number) {
    const portfolio = await this.db.query.portfolios.findFirst({
      where: and(
        eq(portfolios.id, id),
        eq(portfolios.userId, userId) // ë‚´ ê²ƒì¸ì§€ í™•ì¸
      ),
    });

    if (!portfolio) {
      throw new NotFoundException(`í¬íŠ¸í´ë¦¬ì˜¤ #${id}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
    }

    return portfolio;
  }

  // 4. ìˆ˜ì •
  async update(userId: string, id: number, dto: UpdatePortfolioDto) {
    // ë¨¼ì € ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (ì¬ì‚¬ìš©)
    await this.findOne(userId, id);

    const [updated] = await this.db
      .update(portfolios)
      .set({ ...dto, updatedAt: new Date() }) // ìˆ˜ì •ì¼ ì—…ë°ì´íŠ¸
      .where(and(eq(portfolios.id, id), eq(portfolios.userId, userId)))
      .returning();

    return updated;
  }

  // 5. ì‚­ì œ
  async remove(userId: string, id: number) {
    await this.findOne(userId, id); // ì¡´ì¬ í™•ì¸

    await this.db
      .delete(portfolios)
      .where(and(eq(portfolios.id, id), eq(portfolios.userId, userId)));
      
    return { success: true, message: `í¬íŠ¸í´ë¦¬ì˜¤ #${id} ì‚­ì œ ì™„ë£Œ` };
  }
}
```

### ğŸ” ì½”ë“œ ë¶„ì„
| ì½”ë“œ | ì„¤ëª… |
|------|------|
| `@Injectable()` | ì´ í´ë˜ìŠ¤ê°€ DI ì»¨í…Œì´ë„ˆì—ì„œ ê´€ë¦¬ë˜ëŠ” **Provider**ì„ì„ ì„ ì–¸í•©ë‹ˆë‹¤. |
| `@Inject(TOKEN)` | ì»¤ìŠ¤í…€ í”„ë¡œë°”ì´ë”(ì—¬ê¸°ì„  DB ì—°ê²° ê°ì²´)ë¥¼ ì£¼ì…ë°›ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. |
| `.insert().values()` | Drizzleì˜ ë°ì´í„° ì‚½ì… ì¿¼ë¦¬ ë¹Œë”ì…ë‹ˆë‹¤. |
| `.returning()` | Postgresì˜ `RETURNING` êµ¬ë¬¸ì„ ì‹¤í–‰í•˜ì—¬, ì‚½ì…/ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ ë°”ë¡œ ë°˜í™˜ë°›ìŠµë‹ˆë‹¤. |
| `.query.findMany()` | ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì—¬ëŸ¬ í–‰ì„ ì¡°íšŒí•©ë‹ˆë‹¤. |
| `.query.findFirst()` | ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ì²« ë²ˆì§¸ í–‰ë§Œ ì¡°íšŒí•©ë‹ˆë‹¤. (ì—†ìœ¼ë©´ `undefined`) |
| `eq(col, val)` | Drizzle ì¡°ê±´: ì»¬ëŸ¼ ê°’ê³¼ valì´ **ê°™ì€ì§€(Equal)** ë¹„êµí•©ë‹ˆë‹¤. |
| `and(cond1, cond2)` | Drizzle ì¡°ê±´: ì—¬ëŸ¬ ì¡°ê±´ì´ **ëª¨ë‘ ì°¸(AND)** ì´ì–´ì•¼ í•¨ì„ ëª…ì‹œí•©ë‹ˆë‹¤. |
| `NotFoundException` | 404 Not Found HTTP ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ” NestJS ë‚´ì¥ ì˜ˆì™¸ì…ë‹ˆë‹¤. |

---

## 6. ì»¨íŠ¸ë¡¤ëŸ¬ êµ¬í˜„ (ìš”ì²­ ì²˜ë¦¬)

HTTP ìš”ì²­ì„ ë°›ì•„ ì„œë¹„ìŠ¤ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤. Zod íŒŒì´í”„ê°€ ìë™ìœ¼ë¡œ DTOë¥¼ ê²€ì¦í•©ë‹ˆë‹¤.

```typescript
// src/portfolios/portfolios.controller.ts
import { 
  Controller, Get, Post, Body, Patch, Param, Delete, 
  UseGuards, ParseIntPipe 
} from '@nestjs/common';
import { PortfoliosService } from './portfolios.service';
import { CreatePortfolioDto } from './dto/create-portfolio.dto';
import { UpdatePortfolioDto } from './dto/update-portfolio.dto';
import { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';
import { CurrentUser } from '../auth/decorators/current-user.decorator';
import { User } from '../auth/types'; // User íƒ€ì… ì •ì˜ í•„ìš”

@Controller('portfolios') // URL ì ‘ë‘ì‚¬: /portfolios
@UseGuards(JwtAuthGuard)  // ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ëª¨ë“  ìš”ì²­ì€ ë¡œê·¸ì¸ í•„ìš”
export class PortfoliosController {
  constructor(private readonly portfoliosService: PortfoliosService) {}

  @Post()
  create(
    @CurrentUser() user: User, // ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°ë¡œ ìœ ì € ì •ë³´ ê°€ì ¸ì˜´
    @Body() dto: CreatePortfolioDto // ZodValidationPipeê°€ ìë™ ê²€ì¦
  ) {
    return this.portfoliosService.create(user.id, dto);
  }

  @Get()
  findAll(@CurrentUser() user: User) {
    return this.portfoliosService.findAll(user.id);
  }

  @Get(':id')
  findOne(
    @CurrentUser() user: User,
    @Param('id', ParseIntPipe) id: number // URL íŒŒë¼ë¯¸í„°ë¥¼ ìˆ«ìë¡œ ë³€í™˜
  ) {
    return this.portfoliosService.findOne(user.id, id);
  }

  @Patch(':id')
  update(
    @CurrentUser() user: User,
    @Param('id', ParseIntPipe) id: number,
    @Body() dto: UpdatePortfolioDto
  ) {
    return this.portfoliosService.update(user.id, id, dto);
  }

  @Delete(':id')
  remove(
    @CurrentUser() user: User,
    @Param('id', ParseIntPipe) id: number
  ) {
    return this.portfoliosService.remove(user.id, id);
  }
}
```

### ğŸ” ì½”ë“œ ë¶„ì„
| ì½”ë“œ | ì„¤ëª… |
|------|------|
| `@Controller('path')` | ì´ í´ë˜ìŠ¤ê°€ ìš”ì²­ì„ ë°›ëŠ” **ì»¨íŠ¸ë¡¤ëŸ¬**ì„ì„ ì„ ì–¸í•˜ê³ , ê¸°ë³¸ ë¼ìš°íŠ¸ ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. |
| `@UseGuards(Guard)` | í•´ë‹¹ í´ë˜ìŠ¤ë‚˜ ë©”ì„œë“œì— **ì¸ì¦/ì¸ê°€ ê°€ë“œ** ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ì—¬ê¸°ì„  JWT ì¸ì¦ì„ ê°•ì œí•©ë‹ˆë‹¤. |
| `@Post()`, `@Get()` | HTTP ë©”ì„œë“œ(POST, GET, PATCH, DELETE)ì™€ ë§¤í•‘ë˜ëŠ” í•¸ë“¤ëŸ¬ì„ì„ ì„ ì–¸í•©ë‹ˆë‹¤. |
| `@Body()` | ìš”ì²­ ë³¸ë¬¸(Body) ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ì—¬ DTOì— ë§¤í•‘í•©ë‹ˆë‹¤. |
| `@Param('key')` | URL ê²½ë¡œ íŒŒë¼ë¯¸í„°(ì˜ˆ: `:id`) ê°’ì„ ì¶”ì¶œí•©ë‹ˆë‹¤. |
| `@CurrentUser()` | (ì»¤ìŠ¤í…€) ìš”ì²­ê°ì²´(`req.user`)ì—ì„œ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°ì…ë‹ˆë‹¤. |
| `ParseIntPipe` | URL íŒŒë¼ë¯¸í„°(ë¬¸ìì—´)ë¥¼ **ì •ìˆ˜(number)** ë¡œ ë³€í™˜í•´ì£¼ëŠ” íŒŒì´í”„ì…ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ 400 ì—ëŸ¬ë¥¼ ëƒ…ë‹ˆë‹¤. |

---

## 7. ë§ˆë¬´ë¦¬: ì „ì²´ íë¦„ ìš”ì•½

ì´ ì½”ë“œê°€ ì‹¤í–‰ë  ë•Œ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ë´…ì‹œë‹¤.

1.  **ìš”ì²­ ë„ì°©**: `POST /portfolios` ìš”ì²­ì´ ë“¤ì–´ì˜µë‹ˆë‹¤.
2.  **Guard ì‹¤í–‰**: `JwtAuthGuard`ê°€ í—¤ë”ì˜ JWT í† í°ì„ ê²€ì¦í•©ë‹ˆë‹¤. ì‹¤íŒ¨í•˜ë©´ `401 Unauthorized`.
3.  **Pipe ì‹¤í–‰ (`nestjs-zod`)**: `ZodValidationPipe`ê°€ `CreatePortfolioSchema`ì— ë”°ë¼ ë°ì´í„°ë¥¼ ê²€ì¦í•©ë‹ˆë‹¤. ì‹¤íŒ¨í•˜ë©´ `400 Bad Request`ì™€ ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.
4.  **Controller ì‹¤í–‰**: `create()` ë©”ì„œë“œê°€ í˜¸ì¶œë©ë‹ˆë‹¤.
5.  **Service ì‹¤í–‰**: `portfoliosService.create()`ê°€ í˜¸ì¶œë˜ì–´, Drizzleì„ í†µí•´ DBì— ì €ì¥í•©ë‹ˆë‹¤.
6.  **ì‘ë‹µ ë°˜í™˜**: ìƒì„±ëœ í¬íŠ¸í´ë¦¬ì˜¤ ê°ì²´ê°€ JSONìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜ë©ë‹ˆë‹¤.

ì´ì œ ì—¬ëŸ¬ë¶„ì€ NestJS, Drizzle, Zodë¥¼ í™œìš©í•œ **íƒ€ì… ì•ˆì „(Type-Safe)** í•˜ê³  **í™•ì¥ ê°€ëŠ¥**í•œ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
