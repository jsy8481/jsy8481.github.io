---
title: "07. ì—ëŸ¬ ì²˜ë¦¬"
description: "ì„œë²„ê°€ ë»—ì§€ ì•Šë„ë¡ ì˜ˆë°©í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ì—ê²Œ í•­ìƒ ì¹œì ˆí•˜ê³  ì¼ê´€ëœ ì—ëŸ¬ ì‘ë‹µì„ ë‚´ë ¤ì£¼ëŠ” ì „ì—­ ì˜ˆì™¸ í•„í„°(Exception Filter)ë¥¼ ë§ˆìŠ¤í„°í•©ë‹ˆë‹¤."
date: "2026-02-26"
---

# ğŸ·ï¸ 07. ì—ëŸ¬ ì²˜ë¦¬ â€” ê³ ê°ì—ê²Œ ì¹œì ˆí•œ 'ë¶ˆë§Œ ì²˜ë¦¬ ì „ë‹´ë°˜' ë§Œë“¤ê¸°

## ğŸ“‹ ëª©ì°¨
- [ğŸ“Œ ì´ ë¬¸ì„œë¥¼ ì½ê¸° ì „ì—](#-ì´-ë¬¸ì„œë¥¼-ì½ê¸°-ì „ì—)
- [ğŸ¤” ì™œ ì•Œì•„ì•¼ í•˜ëŠ”ê°€](#-ì™œ-ì•Œì•„ì•¼-í•˜ëŠ”ê°€)
- [ğŸ—ï¸ ë¹„ìœ ë¡œ ë¨¼ì € ì´í•´í•˜ê¸°](#-ë¹„ìœ ë¡œ-ë¨¼ì €-ì´í•´í•˜ê¸°)
- [ğŸ§© ë‚´ì¥ ì˜ˆì™¸ì™€ ì»¤ìŠ¤í…€ ì˜ˆì™¸ ğŸŸ¡](#-ë‚´ì¥-ì˜ˆì™¸ì™€-ì»¤ìŠ¤í…€-ì˜ˆì™¸-)
- [ğŸ§© ì „ì—­ ì˜ˆì™¸ í•„í„° (Global Exception Filter) ğŸŸ¢](#-ì „ì—­-ì˜ˆì™¸-í•„í„°-global-exception-filter-)
- [ğŸ§ª ë”°ë¼í•´ë³´ê¸°: ê¶ê·¹ì˜ ê¸€ë¡œë²Œ í•„í„° ê¹ì•„ë³´ê¸°](#-ë”°ë¼í•´ë³´ê¸°-ê¶ê·¹ì˜-ê¸€ë¡œë²Œ-í•„í„°-ê¹ì•„ë³´ê¸°)
- [ğŸ’¼ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ì™€ ì‹¤ë¬´ íŒ](#-ë² ìŠ¤íŠ¸-í”„ë™í‹°ìŠ¤ì™€-ì‹¤ë¬´-íŒ)
- [ğŸ’¥ ì—ëŸ¬ í•´ê²° ì¹´íƒˆë¡œê·¸](#-ì—ëŸ¬-í•´ê²°-ì¹´íƒˆë¡œê·¸)
- [ğŸ—‚ï¸ ì¹˜íŠ¸ì‹œíŠ¸](#ï¸-ì¹˜íŠ¸ì‹œíŠ¸)
- [ğŸ“ ë§ˆë¬´ë¦¬ í€´ì¦ˆ](#-ë§ˆë¬´ë¦¬-í€´ì¦ˆ)

---

## ğŸ“Œ ì´ ë¬¸ì„œë¥¼ ì½ê¸° ì „ì—

**â±ï¸ ì˜ˆìƒ ì½ê¸° ì‹œê°„:** 15ë¶„

**ğŸ§³ ì „ì œ ì§€ì‹ ì²´í¬ë¦¬ìŠ¤íŠ¸**
- [ ] HTTP ìƒíƒœ ì½”ë“œ(400, 401, 404, 500 ë“±)ì˜ ëŒ€ëµì ì¸ ì˜ë¯¸ë¥¼ ì•Œê³  ìˆë‹¤.
- [ ] JavaScriptì˜ `try-catch` ë¬¸ì˜ ì—­í• ê³¼ `throw new Error()` ë¬¸ë²•ì„ ì´í•´í•œë‹¤.

**ğŸ—ºï¸ ì´ ë¬¸ì„œì˜ íë¦„**
NestJS ë‚´ì¥ ì—ëŸ¬ ë±‰ê¸° â†’ ë‚˜ë§Œì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬ë¡œ í¬ì¥í•˜ê¸° â†’ ì„œë²„ í­ë°œì„ ë§‰ëŠ” ì „ì—­ ê·¸ë¬¼ë§(Filter) ë˜ì§€ê¸° â†’ ì‹¤ë¬´ ë¡œê¹… ë° ì—ëŸ¬ ì½”ë“œ ê´€ë¦¬ë²•

**ğŸ¯ ì´ ë¬¸ì„œë¥¼ ë‹¤ ì½ìœ¼ë©´ í•  ìˆ˜ ìˆëŠ” ê²ƒ**
- [ ] ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì§€ì €ë¶„í•œ `try-catch` ë„ë°°ë¥¼ ê±·ì–´ë‚´ê³  ì½”ë“œ ê°€ë…ì„±ì„ 2ë°° ë†’ì¼ ìˆ˜ ìˆë‹¤.
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ íŒŒì‹±í•˜ê¸° ì‰¬ìš´ "ì¼ê´€ëœ JSON ì—ëŸ¬ ì‘ë‹µ í¬ë§·"ì„ ê·œê²©í™”í•  ìˆ˜ ìˆë‹¤.
- [ ] ì•Œ ìˆ˜ ì—†ëŠ” ì¹˜ëª…ì  500 ì—ëŸ¬ ë°œìƒ ì‹œ ì§€ì •ëœ ì±„ë„(Slack ë“±)ë¡œ ì¦‰ì‹œ ì•Œë¦¼ì„ ì˜ëŠ” êµ¬ì¡°ë¥¼ ì§¤ ìˆ˜ ìˆë‹¤.

---

## ğŸ¤” ì™œ ì•Œì•„ì•¼ í•˜ëŠ”ê°€

ì´ˆë³´ ì‹œì ˆ ë°±ì—”ë“œ ì½”ë“œì˜ ê°€ì¥ í° íŠ¹ì§•ì€ ë¼ìš°í„°ë§ˆë‹¤ `try { ... } catch (e) { res.status(500).send(e) }` ê°€ ë„ë°°ë˜ì–´ ìˆë‹¤ëŠ” ê±°ì•¼. 
ì´ë ‡ê²Œ ì§œë©´ í”„ë¡ íŠ¸ì—”ë“œ ì…ì¥ì—ì„œëŠ” ì–´ë–¤ APIëŠ” ì—ëŸ¬ë¥¼ í…ìŠ¤íŠ¸ë¡œ ì£¼ê³ , ì–´ë–¤ APIëŠ” JSONìœ¼ë¡œ ì£¼ê³ , ì‘ë‹µ í˜•íƒœê°€ ì œë©‹ëŒ€ë¡œë¼ ì—ëŸ¬ íŒì—…ì„ ë„ìš°ëŠ” ê²ƒ ìì²´ê°€ ê³ í†µì´ ë¼.
NestJSì˜ **ì˜ˆì™¸ í•„í„°(Exception Filter)** ë¥¼ ë°°ìš°ë©´, ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•œ ê³³ìœ¼ë¡œ ì‹¹ ëª°ì•„ì„œ(ì¤‘ì•™ ì§‘ì¤‘í™”) ìš°ì•„í•˜ê²Œ í”„ë¡ íŠ¸ì—”ë“œì—ê²Œ ì¼ê´€ëœ ì–‘ì‹ì„ ë„˜ê²¨ì¤„ ìˆ˜ ìˆì–´.

---

## ğŸ—ï¸ ë¹„ìœ ë¡œ ë¨¼ì € ì´í•´í•˜ê¸°

> ğŸ§’ **5ì‚´ì—ê²Œ ì„¤ëª…í•œë‹¤ë©´?**
> **ë‚˜ìœ ì‹ë‹¹ (ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë‹¤ ì²˜ë¦¬í•¨):**
> ì£¼ë°©ì¥(Service)ì´ ìš”ë¦¬ë¥¼ íƒœì› ì–´. í™€ì„œë¹™ ì§ì›(Controller)ì´ ì£¼ë°©ì— ë“¤ì–´ê°€ì„œ "ì•„ì´ê³  ë§í–ˆë„¤!" í•˜ê³  ì§ì ‘ ì†ë‹˜í•œí…Œ ë‹¬ë ¤ê°€ "ìš”ë¦¬ê°€ íƒ€ì„œ ëª» ë¨¹ìŠµë‹ˆë‹¤, 500ì› ëŒë ¤ë“œë¦´ê²Œìš”"ë¼ê³  ì‚¬ê³¼í•´. ì§ì›ì´ 100ëª…ì´ë©´ ì‚¬ê³¼ë²•ë„ 100ê°€ì§€ì•¼.
> 
> **ì¢‹ì€ ì‹ë‹¹ (ì˜ˆì™¸ í•„í„° ì‚¬ìš©):**
> ì£¼ë°©ì¥ì€ ê·¸ëƒ¥ ìš”ë¦¬ë¥¼ íƒœìš°ë©´ ì£¼ë°© ë°”ë‹¥ì— ë¶ˆëŸ‰ ìŠ¤í‹°ì»¤(`Exception`)ë¥¼ íƒ ë˜ì§€ê³  ì¿¨í•˜ê²Œ ëŒì•„ì„œ ë²„ë ¤!
> í™€ì„œë¹™ ì§ì›ë„ ì‹ ê²½ ì•ˆ ì¨. ëŒ€ì‹  ì‹ë‹¹ì—ëŠ” **'ê³ ê° ë¶ˆë§Œ ì²˜ë¦¬ ì „ë‹´ë°˜(Exception Filter)'** ì´ë¼ëŠ” ë¶€ì„œê°€ ìˆ¨ì–´ìˆì§€. ì£¼ë°©ì—ì„œ ëˆ„ê°€ ë¶ˆëŸ‰ ìŠ¤í‹°ì»¤ë¥¼ ë˜ì§€ëŠ” ìˆœê°„ 0.1ì´ˆ ë§Œì— ì „ë‹´íŒ€ì´ ì¶œë™í•´ì„œ ë‚šì•„ì±ˆ ë‹¤ìŒ, "ê³ ê°ë‹˜, ë©”ë‰´ê°€ í’ˆì ˆì…ë‹ˆë‹¤(ê¹”ë”í•œ JSON í˜•íƒœ)" ë¼ë©° ë§¤ìš° ì¹œì ˆí•˜ê³  í†µì¼ëœ í†¤ìœ¼ë¡œ ì‘ëŒ€í•˜ëŠ” ê±°ì•¼.

---

## ğŸ§© ë‚´ì¥ ì˜ˆì™¸ì™€ ì»¤ìŠ¤í…€ ì˜ˆì™¸ ğŸŸ¡

> ğŸ¯ **ì´ ì„¹ì…˜ì„ ì½ê³  ë‚˜ë©´:** 
> - ìƒí™©ì— ë§ëŠ” HTTP ì˜ˆì™¸ í´ë˜ìŠ¤ë¥¼ ë˜ì§ˆ(`throw`) ì¤„ ì•ˆë‹¤.

### NestJSê°€ ì¤€ë¹„í•´ ë‘” ê¸°ë³¸ ì˜ˆì™¸ë“¤ (ë¬´ê¸°ê³ )
NestJSëŠ” `HttpException`ì„ ìƒì†ë°›ì€ ìˆ˜ë§ì€ ìƒíƒœì½”ë“œë³„ ë¬´ê¸°ë“¤ì„ ì´ë¯¸ ë‹¤ ì¤€ë¹„í•´ë†¨ì–´.

```typescript
import { NotFoundException, BadRequestException, ConflictException } from '@nestjs/common';

@Injectable()
export class UsersService {
  async getProfile(id: string) {
    const user = await this.db.findById(id);
    
    // ìœ ì €ê°€ ì—†ë‹¤ë©´ í•„í„°ì—ê²Œ í­íƒ„(ì˜ˆì™¸)ì„ ë˜ì§!
    if (!user) {
      // 404 ìƒíƒœì½”ë“œì™€ ë©”ì‹œì§€ê°€ ë‹´ê¸´ ì˜ˆì™¸ ë°œìƒ
      throw new NotFoundException(`íšŒì›ë²ˆí˜¸ ${id}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`); 
    }
    return user;
  }
}
```

**[ì£¼ìš” ë‚´ì¥ ì˜ˆì™¸ ëª©ë¡]**
- `BadRequestException` (400) - íŒŒë¼ë¯¸í„°ë‚˜ ë°”ë””ê°’ì´ í‹€ë ¸ìŒ (04ì¥ ìœ íš¨ì„± ê²€ì‚¬ íŒŒì´í”„ê°€ ë±‰ëŠ” ê²ƒë„ ì´ê±°ì•¼)
- `UnauthorizedException` (401) - í† í° ì—†ìŒ/í‹€ë¦¼ (06ì¥ ê°€ë“œê°€ ë±‰ìŒ)
- `NotFoundException` (404) - ë¦¬ì†ŒìŠ¤ë¥¼ ëª» ì°¾ìŒ
- `ConflictException` (409) - ì´ë©”ì¼ ì¤‘ë³µê°€ì…, ì´ë¯¸ ì¢‹ì•„ìš” ëˆ„ë¦„ ë“± ë¡œì§ ì¶©ëŒ
- `InternalServerErrorException` (500) - DBê°€ ì£½ì—ˆê±°ë‚˜ ë‚´ ì½”ë“œì— ë²„ê·¸ê°€ ìˆê±°ë‚˜

### ë‚˜ë§Œì˜ ì»¤ìŠ¤í…€ ì˜ˆì™¸ ë§Œë“¤ê¸°
"ì”ì•¡ ë¶€ì¡±" ê°™ì€ ë¹„ì¦ˆë‹ˆìŠ¤ íŠ¹í™” ì—ëŸ¬ëŠ” 400 ì—ëŸ¬ì§€ë§Œ, í‰ë²”í•œ 400 ì—ëŸ¬ì™€ëŠ” êµ¬ë¶„ ì§€ì–´ì£¼ê³  ì‹¶ì–´!

```typescript
// common/exceptions/business.exception.ts
export class InsufficientBalanceException extends BadRequestException {
  constructor(required: number, current: number) {
    // í”„ë¡ íŠ¸ì—”ë“œì—ê²Œ ì¤„ JSON ë°ì´í„°ë¥¼ ìƒì„¸í•˜ê²Œ ë§ˆìŒëŒ€ë¡œ ì¡°ë¦½!
    super({
      errorCode: 'INSUFFICIENT_BALANCE',
      message: 'ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤ ã… ã… ',
      details: { required, current } // ë‚¨ì€ ì”ì•¡ì„ ì•Œë ¤ì¤Œ
    });
  }
}
```

---

## ğŸ§© ì „ì—­ ì˜ˆì™¸ í•„í„° (Global Exception Filter) ğŸŸ¢

ì´ì œ ì£¼ë°©(ì„œë¹„ìŠ¤/ì»¨íŠ¸ë¡¤ëŸ¬)ì—ì„œ ë˜ì§€ëŠ” ëª¨ë“  ì—ëŸ¬ë¥¼ í—ˆê³µì—ì„œ ë‚šì•„ì±„ì„œ, ì˜ˆìœ í¬ì¥ì§€ì— ë‹´ì•„ì£¼ëŠ” 'ë¶ˆë§Œ ì²˜ë¦¬ ì „ë‹´ë°˜'ì„ ë§Œë“¤ ì°¨ë¡€ì•¼.

```typescript
// common/filters/http-exception.filter.ts
import { ExceptionFilter, Catch, ArgumentsHost, HttpException, HttpStatus } from '@nestjs/common';
import { Response } from 'express'; // Fastify ì“°ë©´ FastifyReply ì ìš©

@Catch() // ğŸ‘ˆ ì•„ë¬´ ê´„í˜¸ë„ ì•ˆ ì ìœ¼ë©´ 'ì—ëŸ¬ë‚˜ëŠ” ëª¨ë“  ê²ƒ'ì„ ë‹¤ ì¡ì•„ì±„ê² ë‹¤ëŠ” ëœ»!
export class GlobalExceptionFilter implements ExceptionFilter {
  
  // ì—ëŸ¬ê°€ íŠ¸ë¦¬ê±°ë˜ëŠ” ìˆœê°„ ì—¬ê¸°ê°€ ë¬´ì¡°ê±´ ì‹¤í–‰ë¨
  catch(exception: unknown, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse<Response>();
    const request = ctx.getRequest<Request>();
    
    // 1. ìƒíƒœ ì½”ë“œ íŒë³„ (ë‚´ê°€ ë˜ì§„ ì—ëŸ¬ë©´ ê·¸ ì½”ë“œ, ì•„ë‹ˆë©´ ë¬´ì¡°ê±´ 500 ì²˜ë¦¬)
    const status = 
      exception instanceof HttpException 
        ? exception.getStatus() 
        : HttpStatus.INTERNAL_SERVER_ERROR;

    // 2. ìµœì¢… í”„ë¡ íŠ¸ì—”ë“œì—ê²Œ ë‚´ë ¤ê°ˆ í†µì¼ëœ JSON í¬ë§·!
    response.status(status).json({
      success: false,   // ë¬´ì¡°ê±´ ë“¤ì–´ê°€ëŠ” ê³µí†µ ìƒíƒœ
      timestamp: new Date().toISOString(),
      path: request.url,
      
      // ë‚´ê°€ ë˜ì§„ ì—ëŸ¬ë¼ë©´ ì•Œë§¹ì´ë¥¼ ë¹¼ì˜¤ê³ , ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬ë©´ ì„ì˜ ë©”ì„¸ì§€
      error: exception instanceof HttpException 
        ? exception.getResponse() 
        : 'ì•—! ì„œë²„ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë§ ì˜¤ë¥˜ì…ë‹ˆë‹¤!',
    });
  }
}
```

ì´ í•„í„°ë¥¼ ê±´ë¬¼ ì „ì²´ì— í™œì„±í™”ì‹œí‚¤ë©´ ëì´ì•¼. `main.ts` ë¡œ ê°„ë‹¤!

```typescript
// main.ts
async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  
  // ê¸€ë¡œë²Œ í•„í„° ì¥ì°©! ì´ì œ 365ì¼ ì—ëŸ¬ ì•ˆ ë†“ì¹¨.
  app.useGlobalFilters(new GlobalExceptionFilter());
  
  await app.listen(3000);
}
```

---

## ğŸ§ª ë”°ë¼í•´ë³´ê¸°: ê¶ê·¹ì˜ ê¸€ë¡œë²Œ í•„í„° ê¹ì•„ë³´ê¸°

ì‹¤ë¬´ì—ì„œëŠ” NestJS ìœ íš¨ì„± ê²€ì‚¬ ì—ëŸ¬, Zod ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²€ì‚¬ ì—ëŸ¬, ì•Œ ìˆ˜ ì—†ëŠ” ì¹˜ëª…ì  500 ì—ëŸ¬ ë“±ì„ í•„í„° ì•ˆì—ì„œ ë¶„ê¸° ì²˜ë¦¬í•´ì•¼ í•´. ê±°ê¸°ì— 500 ì—ëŸ¬ ë°œìƒ ì‹œ í„°ë¯¸ë„ ë¡œê¹…ê¹Œì§€ ë¶™ì—¬ë³´ì.

```typescript
import { ExceptionFilter, Catch, ArgumentsHost, HttpException, HttpStatus, Logger } from '@nestjs/common';
import { HttpAdapterHost } from '@nestjs/core';
import { ZodError } from 'zod'; // Zod ì“¸ ë•Œ

@Catch()
export class MegaGlobalFilter implements ExceptionFilter {
  // ë¡œê±° ì¥ì°©
  private readonly logger = new Logger(MegaGlobalFilter.name);

  // HttpAdapterHostë¥¼ ì“°ë©´ Expressë“  Fastifyë“  í”„ë ˆì„ì›Œí¬ ì¢…ì†ì„± ì—†ì´ ì‘ë‹µ(Reply) ê°€ëŠ¥!
  constructor(private readonly httpAdapterHost: HttpAdapterHost) {}

  catch(exception: unknown, host: ArgumentsHost) {
    const { httpAdapter } = this.httpAdapterHost;
    const ctx = host.switchToHttp();
    const request = ctx.getRequest();

    let status = HttpStatus.INTERNAL_SERVER_ERROR;
    let message = 'ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
    let errorCode = 'UNKNOWN_ERROR';

    // ë¶„ê¸° 1: ë‚´ê°€ ì•Œê³  ë˜ì§„ HTTP ì—ëŸ¬ (400, 401, 404 ë“±)
    if (exception instanceof HttpException) {
      status = exception.getStatus();
      const res = exception.getResponse() as any;
      message = typeof res === 'string' ? res : (res.message || 'Error');
      errorCode = res.errorCode || 'HTTP_ERROR';
    } 
    // ë¶„ê¸° 2: Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¤íŒ¨ ì—ëŸ¬
    else if (exception instanceof ZodError) {
      status = HttpStatus.BAD_REQUEST;
      message = 'ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
      errorCode = 'ZOD_VALIDATION_ERROR';
    } 
    // ë¶„ê¸° 3: ì§„ì§œ ì„œë²„ê°€ í„°ì§€ëŠ” ë²„ê·¸ (null.abc ì ‘ê·¼, DB ì ‘ì† ì§€ì—° ë“±) => 500
    else {
      // ğŸš¨ ì¹˜ëª…ì  ì—ëŸ¬ëŠ” ë¬´ì¡°ê±´ ìì„¸í•˜ê²Œ ë¡œê¹…! (ë˜ëŠ” ì—¬ê¸°ì„œ ìŠ¬ë™ API í˜¸ì¶œ)
      this.logger.error(
        `[${request.method}] ${request.url} - ${exception}`,
        (exception as Error)?.stack,
      );
    }

    // í†µì¼ëœ ì‘ë‹µ ê·œê²©
    const responseBody = {
      statusCode: status,
      errorCode,
      message,
      timestamp: new Date().toISOString(),
      path: httpAdapter.getRequestUrl(request),
    };

    httpAdapter.reply(ctx.getResponse(), responseBody, status);
  }
}
```

**ì•±ì— ë“±ë¡í•  ë•ŒëŠ” `HttpAdapterHost` ì£¼ì…ì— ì¹˜ì‚¬í•˜ê²Œ ì£¼ì˜í•´ì•¼ í•´:**
```typescript
// main.ts
const httpAdapterHost = app.get(HttpAdapterHost); // ì–´ëŒ‘í„° ê°€ì ¸ì˜¤ê¸°!
app.useGlobalFilters(new MegaGlobalFilter(httpAdapterHost));
```

---

## ğŸ’¼ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ì™€ ì‹¤ë¬´ íŒ ğŸŸ¡

### 1. ì»¨íŠ¸ë¡¤ëŸ¬ ì•ˆì—ì„œ ëª…ì‹œì ì¸ `try-catch`ëŠ” ìµœëŒ€í•œ ì§€ìš´ë‹¤.
ê°€ì¥ ë§ì´ í•˜ëŠ” ì´ˆë³´ì˜ ì‹¤ìˆ˜ê°€ ëª¨ë“  ë¼ìš°í„°ë§ˆë‹¤ `try-catch`ë¥¼ ë§ì”Œìš°ëŠ” ê±°ì•¼. 
"ë§Œì•½ ë¡œì§ ì§œë‹¤ ì—ëŸ¬ ë‚˜ë©´ ì–´ë–¡í•´ìš”?" -> **ì–´ì°¨í”¼ ê¸€ë¡œë²Œ í•„í„°ê°€ ë‹¤ ì¡ì•„!** ê·¸ëƒ¥ ì„œë¹„ìŠ¤ í•¨ìˆ˜ ì­‰ ì“°ê³  ë§Œì•½ ì´ìƒí•˜ë©´ ì„œë¹„ìŠ¤ ì•ˆì—ì„œ `throw new NotFoundException()` ë§Œ ë˜ì ¸ ë²„ë ¤. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„¸ìƒ í¸í•˜ê²Œ ë¡œì§ë§Œ í˜¸ì¶œí•˜ëŠ” ê²Œ ê°€ì¥ ì™„ë²½í•œ í˜•íƒœì•¼.

### 2. ì—ëŸ¬ ì½”ë“œëŠ” í•œ ê³³ì— ëª¨ì•„ ìƒìˆ˜ë¡œ ê´€ë¦¬í•˜ë¼
í•˜ë“œì½”ë”©ëœ ì—ëŸ¬ ì½”ë“œë¥¼ ë§ˆêµ¬ ì“°ë©´, ë‚˜ì¤‘ì— í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ ë¶„ê¸° ì²˜ë¦¬í•  ë•Œ ê³ í†µìŠ¤ëŸ¬ì›Œ.

```typescript
// common/error-codes.ts
export const ErrorCodes = {
  USER_NOT_FOUND: 'USER_NOT_FOUND',
  EMAIL_EXISTS: 'EMAIL_EXISTS',
  TOKEN_EXPIRED: 'TOKEN_EXPIRED',
} as const;

// ì‚¬ìš©í•  ë•Œ
throw new BadRequestException({ errorCode: ErrorCodes.EMAIL_EXISTS });
```

---

## ğŸ’¥ ì—ëŸ¬ í•´ê²° ì¹´íƒˆë¡œê·¸

> ì—ëŸ¬ ë©”ì‹œì§€ê°€ ëœ¨ë©´ Ctrl+Fë¡œ ê²€ìƒ‰í•´ë´.

### âŒ `UnhandledPromiseRejectionWarning` (ì„œë²„ ë‹¤ìš´)

**í˜„ìƒ:**
ì„œë²„ê°€ ì™„ì „íˆ í‘¹ êº¼ì§. ë¬´ì–¸ê°€ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜ˆì™¸ë¼ë©° ë»˜ê±´ ê¸€ì”¨ ì¥ë¬¸ì´ í„°ë¯¸ë„ì— ëœ¸.
**ì›ì¸:**
ë†€ëê²Œë„ ê¸€ë¡œë²Œ ì˜ˆì™¸ í•„í„°ë¥¼ ê±°ì¹˜ì§€ ì•Šì€ ì—ëŸ¬ì•¼. ì´ ê²½ìš°ëŠ” **ë¹„ë™ê¸° í•¨ìˆ˜ (Promise) ì•ˆì—ì„œ ì—ëŸ¬ê°€ ë‚¬ëŠ”ë° `await`ë¥¼ ì•ˆ ê±¸ì–´ì¤˜ì„œ** íƒ€ì´ë°ì´ ì–´ê¸‹ë‚œ ì±„ ìš°ì£¼ ë°– ë¯¸ì•„ë¡œ ì—ëŸ¬ê°€ í„°ì ¸ë²„ë¦° ê²½ìš°ì•¼.
**í•´ê²°ì±…:**
ì—ëŸ¬ê°€ ë‚œ `Promise`ë¥¼ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜(ì˜ˆ: DB ì €ì¥ ë¡œì§) ì•ì— `await`ë¥¼ ì˜ ê¸°ì¬í–ˆëŠ”ì§€ ì²´í¬! 

### âŒ `TypeError: Cannot read properties of undefined (reading 'switchToHttp')`

**ì›ì¸:**
í•„í„°ì—ì„œ `ArgumentsHost`ë¥¼ ì¨ì•¼ í•˜ëŠ”ë° ë­”ê°€ ê°ì²´ êµ¬ì¡° ì¸ì‹ì„ ì˜ëª»í–ˆìŒ. ì£¼ë¡œ WebSocketì´ë‚˜ GraphQL ê°™ì´ HTTPê°€ ì•„ë‹Œ í™˜ê²½ì—ì„œ ê°•ì œë¡œ `.switchToHttp()`ë¥¼ ì–µì§€ë¡œ êº¼ë‚´ë ¤ í•  ë•Œ ë°œìƒí•˜ê¸°ë„ í•´.
**í•´ê²°ì±…:**
ë§Œì•½ HTTP ì „ìš© ì•±ì´ ì•„ë‹ˆë¼ë©´ `host.getType() === 'http'` ë¡œ ë¶„ê¸° ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ ì•ˆì „í•´.

---

## ğŸ—‚ï¸ ì¹˜íŠ¸ì‹œíŠ¸ â€” ì‹¤ë¬´ ìš”ì•½ ì¹´ë“œ

| ìƒí™© | ì‚¬ìš© ì˜ˆì‹œ | ë¹„ê³  |
|------|-----------|------|
| **ë¦¬ì†ŒìŠ¤ ëª» ì°¾ìŒ** | `throw new NotFoundException()` | HTTP 404 ë‚´ë ¤ê° |
| **ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬** | `throw new BadRequestException()` | ëŒ€ë¶€ë¶„ì˜ ì—ëŸ¬ (400) |
| **íŒŒì´í”„/ê°€ë“œ ë°–ì—ì„œ ë‹¤ ì¡ê¸°** | `@Catch()` ë‹¬ë¦° í´ë˜ìŠ¤ ìƒì„± | ê¸€ë¡œë²Œ í•„í„° ì™„ì„± |
| **ì „ì—­ í•„í„° ì ìš©** | `app.useGlobalFilters(new MyFilter())` | `main.ts` í•„ìˆ˜ ê¸°ì¬ |

---

## ğŸ“ ë§ˆë¬´ë¦¬ í€´ì¦ˆ

**Q1. NestJSì—ì„œ ì¢‹ì€ ì•„í‚¤í…ì²˜ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ê¶Œì¥í•˜ëŠ” ì—ëŸ¬ ì²˜ë¦¬ ë°©ì‹ ì¤‘ ê°€ì¥ ì˜³ì€ ê²ƒì€?**

- A) ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë¼ìš°í„° ë‚´ë¶€ì— `try { } catch() { }` ë¸”ë¡ì„ ì‘ì„±í•˜ì—¬ ì§ì ‘ 500 ìƒíƒœ ì½”ë“œë¥¼ `res.send()` í•œë‹¤.
- B) ì„œë¹„ìŠ¤(Service) ë ˆì´ì–´ì˜ ëª¨ë“  ë°˜í™˜ê°’ì„ ì—ëŸ¬ì¸ì§€ í™•ì¸í•˜ëŠ” `if (result.error)` ê²€ì‚¬ë¥¼ ì´˜ì´˜íˆ ì§ ë‹¤.
- C) ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ ê³ ë¯¼ì„ ëœê³ , ë¡œì§ ì¤‘ ë¬¸ì œê°€ ìƒê¸°ë©´ ì˜ˆì™¸(`Exception`)ë¥¼ `throw`í•˜ì—¬ ì „ì—­ í•„í„°ê°€ ì²˜ë¦¬í•˜ê²Œ ë§¡ê¸´ë‹¤.

> âœ… **ì •ë‹µ: C**
> **ì„¤ëª…:** í•„í„°ì˜ ì¡´ì¬ ì´ìœ ì•¼. í™€ì„œë¹™ ì§ì›(Controller)ì€ ìš”ë¦¬ ì£¼ë¬¸ë§Œ ë°›ê³  ê°–ë‹¤ì£¼ê³  í¸í•˜ê²Œ ì¼í•´ì•¼ í•´. ëŒë°œ ìƒí™© ì²˜ë¦¬ëŠ” ë¶ˆë§Œ ì²˜ë¦¬ë°˜(Global Exception Filter)ì— ì¤‘ì•™ì§‘ê¶Œí™” ì‹œì¼œì„œ í†µì¼ë˜ê²Œ ì‘ë‹µí•˜ëŠ” ê²ƒì´ ìµœê³ ì•¼.

**Q2. í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ API ì‘ë‹µì„ ë°›ì•˜ëŠ”ë° ì—ëŸ¬ í˜•íƒœê°€ íŒŒì‹±í•˜ê¸° ë„ˆë¬´ í˜ë“¤ë‹¤ê³  í•­ì˜í•œë‹¤. ì´ë¥¼ ì™„ì „íˆ ê·œê²©í™”(ì˜ˆ: `{ success: false, msg: "...", code: "..." }`) í•´ì„œ í•œ ë°©ì— ì²˜ë¦¬í•˜ê³  ì‹¶ì€ë°, ê¼­ ì‘ì„±í•´ì•¼ í•˜ëŠ” í´ë˜ìŠ¤ì˜ ë°ì½”ë ˆì´í„°ì™€ ìƒì† íƒ€ì…ì€ ë¬´ì—‡ì¸ê°€?**

> âœ… **ì •ë‹µ:** `@Catch()` ë°ì½”ë ˆì´í„°ë¥¼ ë¶™ì´ê³ , `ExceptionFilter` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„(implements)í•œ í•„í„° ê°ì²´ë¥¼ ì‘ì„±í•œë‹¤!

**Q3. ë””ë²„ê¹… í€´ì¦ˆ: ì•„ë˜ ì½”ë“œì—ì„œ `HttpAdapterHost`ë¥¼ ë‹¤ë£° ë•Œ ë¹¼ë¨¹ì–´ì„  ì•ˆ ë  `main.ts` ë“±ë¡ ê³¼ì •ì„ ì„œìˆ í•´ë´.**

```typescript
@Catch()
export class HttpFilter implements ExceptionFilter {
  constructor(private readonly httpAdapterHost: HttpAdapterHost) {}
}
```

> âœ… **ì •ë‹µ:** ë¹Œë“œëœ `app` ê°ì²´ì—ì„œ ì–´ëŒ‘í„°ë¥¼ ê°€ì ¸ì™€ ì¸ìë¡œ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.
> **ì„¤ëª…:** `const httpAdapterHost = app.get(HttpAdapterHost);` ì´ë ‡ê²Œ `app.get()` ëª…ë ¹ì–´ë¡œ ì»¨í…Œì´ë„ˆì—ì„œ êº¼ë‚´ì˜¨ ë’¤ì— `app.useGlobalFilters(new HttpFilter(httpAdapterHost))` ì™€ ê°™ì´ ë„£ì–´ì¤˜ì•¼ ì˜ì¡´ì„±ì´ ê¹¨ì§€ì§€ ì•Šì•„.

---

## ğŸ”— ë” ì•Œì•„ë³´ê¸°
- [NestJS - Exception Filters (ê³µì‹ ë¬¸ì„œ)](https://docs.nestjs.com/exception-filters)
- [Node.js ë¹„ë™ê¸° ì—ëŸ¬ í•¸ë“¤ë§ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤](https://github.com/goldbergyoni/nodebestpractices)
- [08. ì‹¤ì „ íŒê³¼ í™˜ê²½ ì„¤ì • í†µí•© ê°€ì´ë“œ](./08-practical-guide.mdx)
